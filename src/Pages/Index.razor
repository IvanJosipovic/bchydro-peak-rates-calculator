@page "/"
@using CsvHelper;
@using System.Globalization;
@using CsvHelper.Configuration;

<PageTitle>BC Hydro Peak Rates Calculator</PageTitle>

<MudContainer MaxWidth="MaxWidth.Medium">
    <MudText Typo="Typo.h4">BC Hydro Peak Rates Calculator</MudText>

    <MudFileUpload T="IBrowserFile" FilesChanged="UploadFiles" Accept=".csv" MaximumFileCount="1">
        <ButtonTemplate>
            <MudButton HtmlTag="label"
                       Variant="Variant.Filled"
                       Color="Color.Primary"
                       StartIcon="@Icons.Material.Filled.CloudUpload"
                       for="@context">
                Load CSV
            </MudButton>
        </ButtonTemplate>
    </MudFileUpload>

    <MudDataGrid Items="@finalData">
        <Columns>
            <Column T="AggregatedData" Title="Month & Year">
                <CellTemplate>
                    @context.Item.IntervalStartDateTime.Month/@context.Item.IntervalStartDateTime.Year
                </CellTemplate>
            </Column>
            <Column T="AggregatedData" Field="NetConsumption">
                <CellTemplate>
                    @context.Item.NetConsumption.ToString("F2")kw
                </CellTemplate>
            </Column>

            <Column T="AggregatedData" Field="OldCost">
                <CellTemplate>
                    $@context.Item.OldCost.ToString("F2")
                </CellTemplate>
            </Column>
            <Column T="AggregatedData" Field="NewCost">
                <CellTemplate>
                    $@context.Item.NewCost.ToString("F2")
                </CellTemplate>
            </Column>
        </Columns>
    </MudDataGrid>
</MudContainer>

